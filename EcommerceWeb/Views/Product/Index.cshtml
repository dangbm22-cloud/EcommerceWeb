@model List<EcommerceWeb.Models.Product>

<!-- Breadcrumb Section -->
<section class="breadcrumb-section set-bg" data-setbg="/img/breadcrumb.jpg">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 text-center">
                <div class="breadcrumb__text">
                    <h2>DKT Shop</h2>
                    <div class="breadcrumb__option">
                        <a asp-controller="Home" asp-action="Index">Home</a>
                        <span>Shop</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Product Section -->
<section class="product spad">
    <div class="container">
        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-3 col-md-5">
                <div class="sidebar">
                    <div class="sidebar__item">
                        <h4>Tìm kiếm & Lọc</h4>
                        <form method="get" asp-action="Index">
                            <!-- Tìm theo tên -->
                            <div class="form-group mb-3">
                                <input type="text" name="search" placeholder="Nhập tên sản phẩm..." class="form-control" />
                            </div>

                            <!-- Lọc theo danh mục -->
                            <div class="form-group mb-4">
                                <select name="category" class="form-control">
                                    <option value="">-- Chọn danh mục --</option>
                                    <option value="CPU">CPU</option>
                                    <option value="Mainboard">Mainboard</option>
                                    <option value="RAM">RAM</option>
                                    <option value="VGA">VGA</option>
                                    <option value="PSU">Nguồn</option>
                                    <option value="PC">PC lắp sẵn</option>
                                </select>
                            </div>

                            <!-- Lọc theo giá -->
                            <div class="price-range-wrap mb-4">
                                <label class="mb-2">Khoảng giá (VND)</label>
                                <div id="price-range"></div>
                                <div class="range-slider mt-3">
                                    <div class="price-input">
                                        <!-- Hiển thị đẹp -->
                                        <input type="text" id="minamount_display" readonly />
                                        <input type="text" id="maxamount_display" readonly />
                                        <!-- Hidden để submit -->
                                        <input type="hidden" id="minamount" name="minPrice" />
                                        <input type="hidden" id="maxamount" name="maxPrice" />
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="btn btn-primary w-100">Lọc</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Danh sách sản phẩm -->
            <div class="col-lg-9 col-md-7">
                <div class="filter__found mb-3">
                    <h6><span>@Model.Count</span> sản phẩm tìm thấy</h6>
                </div>
                <div class="row">
                    @if (Model.Any())
                    {
                        @foreach (var item in Model)
                        {
                            <div class="col-lg-4 col-md-6 col-sm-6">
                                <div class="product__item">
                                    <div class="product__item__pic">
                                        <!-- Hình có thể nhấn vô để chuyển sang trang chi tiết -->
                                        <a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id">
                                            <img src="@item.ImageUrl" alt="@item.Name" class="zoom-img" />
                                        </a>
                                        <ul class="product__item__pic__hover">
                                            <li><a href="#"><i class="fa fa-heart"></i></a></li>
                                            <li>
                                                <a asp-controller="Cart" asp-action="Add" asp-route-id="@item.Id">
                                                    <i class="fa fa-shopping-cart"></i>
                                                </a>
                                            </li>
                                        </ul>
                                    </div>
                                    <div class="product__item__text">
                                        <!-- Nhân vô tên có thể chuyển sang trang chi tiết sản phẩm -->
                                        <h6>
                                            <a asp-controller="Product" asp-action="Details" asp-route-id="@item.Id">
                                                @item.Name
                                            </a>
                                        </h6>
                                        <span>@string.Format("{0:N0} VND", item.Price)</span>
                                    </div>
                                </div>
                            </div>
                        }
                    }
                    else
                    {
                        <div class="col-12">
                            <p>Không tìm thấy sản phẩm nào.</p>
                        </div>
                    }
                </div>
            </div>
        </div>
    </div>
</section>

@section Scripts {
    <script>
        $(function () {
            $("#price-range").slider({
                range: true,
                min: 0,
                max: 50000000,
                step: 50000,
                values: [0, 50000000],
                slide: function (event, ui) {
                    // Hiển thị đẹp
                    $("#minamount_display").val(ui.values[0].toLocaleString('vi-VN') + " VND");
                    $("#maxamount_display").val(ui.values[1].toLocaleString('vi-VN') + " VND");

                    // Giá trị số để submit
                    $("#minamount").val(ui.values[0]);
                    $("#maxamount").val(ui.values[1]);
                }
            });

            // Giá trị ban đầu
            $("#minamount_display").val($("#price-range").slider("values", 0).toLocaleString('vi-VN') + " VND");
            $("#maxamount_display").val($("#price-range").slider("values", 1).toLocaleString('vi-VN') + " VND");

            $("#minamount").val($("#price-range").slider("values", 0));
            $("#maxamount").val($("#price-range").slider("values", 1));
        });
    </script>
}


